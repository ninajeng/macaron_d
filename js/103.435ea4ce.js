"use strict";(self["webpackChunkproject_macaron"]=self["webpackChunkproject_macaron"]||[]).push([[103],{6687:function(t,e,s){s.d(e,{Z:function(){return x}});var r=s(3396),i=s(7139),o=s(9242);const a={class:"py-1 border-top mb-0"},n={class:"d-flex justify-content-between"},l=(0,r._)("p",{class:"mb-1"},"小計",-1),d={class:"mb-1"},c=(0,r._)("div",{class:"d-flex justify-content-between"},[(0,r._)("p",{class:"mb-1"},"運費"),(0,r._)("p",{class:"mb-1"},"活動免運")],-1),u={key:0,class:"input-group mb-2 pt-1"},p={key:1,class:"d-flex justify-content-between flex-wrap"},m={class:"w-100 mb-1"},g={class:"mb-1"},b={class:"mb-1 flex-fill text-end"},h={class:"d-flex justify-content-between border-top pt-1"},_=(0,r._)("p",{class:"mb-1"},"總金額",-1),f={class:"mb-1 fw-bolder"};function w(t,e,s,w,y,k){const v=(0,r.up)("WebLoading");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(v,{"is-loading":y.isLoading},null,8,["is-loading"]),(0,r._)("div",{class:(0,i.C_)(["card mb-5 border-secondary",{"border-0":!s.isEdit}])},[(0,r._)("div",{class:(0,i.C_)(["card-body",{"p-0":!s.isEdit}])},[(0,r._)("h5",{class:(0,i.C_)(["fw-normal",{"fw-bolder ms-2":s.isEdit}])},[(0,r.WI)(t.$slots,"title",{},(()=>[(0,r.Uk)("訂單確認")]))],2),(0,r._)("div",{class:(0,i.C_)(s.isEdit?"px-2":"text-gray")},[(0,r._)("p",a,(0,i.zw)(`商品共 ${s.cartInfo.carts.reduce(((t,e)=>t+e.qty),0)} 件`),1),(0,r._)("div",n,[l,(0,r._)("p",d,(0,i.zw)(t.$filters.currency(s.cartInfo.total)),1)]),c,s.isEdit?((0,r.wg)(),(0,r.iD)("div",u,[(0,r.wy)((0,r._)("input",{type:"text",class:"form-control border-gray border-end-0",placeholder:"輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>y.couponCode=t)},null,512),[[o.nr,y.couponCode]]),(0,r._)("button",{type:"button",class:"btn btn-outline-gray",onClick:e[1]||(e[1]=(...t)=>k.useCoupon&&k.useCoupon(...t))}," 套用 ")])):(0,r.kq)("",!0),s.cartInfo.carts[0].coupon?((0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("p",m,[(0,r.WI)(t.$slots,"coupon",{},(()=>[(0,r.Uk)("已套用的優惠券：")]))]),(0,r._)("p",g,(0,i.zw)(`${s.cartInfo.carts[0].coupon.code} ${s.cartInfo.carts[0].coupon.title}`),1),(0,r._)("p",b,(0,i.zw)(`-${t.$filters.currency(s.cartInfo.total-s.cartInfo.final_total)}`),1)])):(0,r.kq)("",!0),(0,r._)("div",h,[_,(0,r._)("p",f,(0,i.zw)(`NT$ ${t.$filters.currency(s.cartInfo.final_total)}`),1)])],2),(0,r.WI)(t.$slots,"button")],2)],2)],64)}var y={data(){return{couponCode:"",isLoading:!1}},props:["cartInfo","isEdit"],inject:["emitter"],methods:{useCoupon(){const t="https://vue3-course-api.hexschool.io/api/nn_macaron/coupon";this.isLoading=!0,this.axios.post(t,{data:{code:this.couponCode}}).then((t=>{t.data.success?(this.emitter.emit("sendMsg",{message:"已套用優惠",status:"success"}),this.emitter.emit("updateCart")):this.couponError(t.data.message),this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.couponError(t)}))},couponError(t){this.emitter.emit("sendMsg",{message:t,status:"error"})}}},k=s(89);const v=(0,k.Z)(y,[["render",w]]);var x=v},5486:function(t,e,s){s.d(e,{Z:function(){return L}});var r=s(3396),i=s(7139);const o={class:"row g-2 g-sm-3"},a={key:0,class:"col-12 border-bottom pb-3"},n=(0,r._)("h5",{class:"fw-bolder mb-3"},"選擇付款方式",-1),l={key:0,class:"d-flex mb-3 text-warning-emphasis"},d=(0,r._)("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1),c=(0,r._)("p",{class:"mb-0",style:{"background-image":"linear-gradient(\r\n                  transparent 60%,\r\n                  var(--bs-warning-bg-subtle) 40%\r\n                )"}}," 訂單尚未完成，請完成付款手續 ",-1),u=[d,c],p={class:"input-group"},m={class:"form-select"},g=(0,r._)("option",{value:"線上刷卡"},"線上刷卡",-1),b=(0,r._)("option",{value:"ATM轉帳"},"ATM轉帳",-1),h={value:"門市付款"},_={key:1,class:"col-12"},f={class:"mb-0 d-none d-sm-inline-block",style:{"background-image":"linear-gradient(\r\n                transparent 60%,\r\n                var(--bs-success-bg-subtle) 40%\r\n              )"}},w={class:"mb-2 d-sm-none bg-success-subtle p-3 rounded lh-lg"},y=(0,r._)("div",{class:"col-sm-4"},[(0,r._)("h5",{class:"fs-6 mb-0 mt-2 mt-sm-0 fw-semibold"},"訂單狀態")],-1),k={class:"col-sm-8 text-gray"},v={class:"mb-0"},x=(0,r._)("div",{class:"col-sm-4"},[(0,r._)("h5",{class:"fs-6 mt-2 mt-sm-0 mb-0 fw-semibold"},"訂購人資料")],-1),$={class:"col-sm-8 text-gray"},C={class:"mb-1"},D={class:"mb-1"},z={class:"mb-1"},I={key:0,class:"mb-0",style:{"text-align":"justify"}};function O(t,e,s,d,c,O){const q=(0,r.up)("WebLoading");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(q,{"is-loading":c.isLoading},null,8,["is-loading"]),c.order.user?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,i.C_)(c.order.is_paid?"mb-3":"mb-5")},[(0,r._)("div",{class:(0,i.C_)(["container p-0",{"mb-3 border-secondary p-4 border rounded":!c.order.is_paid}])},[(0,r._)("div",o,[c.order.is_paid?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",a,[n,c.order.is_paid?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",l,u)),(0,r._)("div",p,[(0,r._)("select",m,[g,b,(0,r._)("option",h,(0,i.zw)(c.order.user.address.indexOf("門市取貨")>-1?"門市取貨付款":"門市付款"),1)]),(0,r._)("button",{type:"button",class:"btn btn-secondary",onClick:e[0]||(e[0]=(...t)=>O.payment&&O.payment(...t))}," 付款 ")])])),c.order.is_paid?((0,r.wg)(),(0,r.iD)("div",_,[(0,r._)("p",f,(0,i.zw)(""+(c.order.user.address.indexOf("門市取貨")>-1?"商品將於七個工作天內完成，我們將與您聯繫確認取貨日期。":"商品將於七個工作天內送達。")),1),(0,r._)("p",w,(0,i.zw)(""+(c.order.user.address.indexOf("門市取貨")>-1?"商品將於七個工作天內完成，我們將與您聯繫確認取貨日期。":"商品將於七個工作天內送達。")),1)])):(0,r.kq)("",!0),y,(0,r._)("div",k,[(0,r._)("p",v,(0,i.zw)(c.order.is_paid?"訂單已成立":"尚未付款"),1)]),x,(0,r._)("div",$,[(0,r._)("p",C,(0,i.zw)(c.order.user.name),1),(0,r._)("p",D,(0,i.zw)(c.order.user.tel),1),(0,r._)("p",z,(0,i.zw)(c.order.user.email),1),(0,r._)("p",{class:(0,i.C_)(["mb-0",{"mb-1":c.order.message}])},(0,i.zw)(c.order.user.address),3),c.order.message?((0,r.wg)(),(0,r.iD)("p",I,(0,i.zw)(`訂單備註："${c.order.message}"`),1)):(0,r.kq)("",!0)])])],2)],2)):(0,r.kq)("",!0)],64)}s(560);var q={data(){return{order:{},orderProducts:{},orderId:"",isLoading:!1}},inject:["emitter"],emits:["orderData","getError"],props:["isSearch"],methods:{getOrder(t){const e=`https://vue3-course-api.hexschool.io/api/nn_macaron/order/${t}`;this.isLoading=!0,this.axios.get(e).then((e=>{e.data.success?(e.data.order.is_paid&&"complete"!==this.$route.name?this.$router.push(`/order/complete/${t}`):e.data.order.is_paid||"payment"===this.$route.name||this.$router.push(`/order/payment/${t}`),this.order=e.data.order,this.orderProducts.carts=Object.values(e.data.order.products),this.orderProducts.final_total=e.data.order.total,this.orderProducts.total=this.orderProducts.carts.reduce(((t,e)=>(t+=e.total,t)),0),this.$emit("orderData",this.orderProducts)):this.getOrderFail(),this.isLoading=!1})).catch((()=>{this.isLoading=!1,this.getOrderFail()}))},getOrderFail(){this.isSearch?this.$emit("getError"):(this.emitter.emit("sendMsg",{message:"無此訂單",status:"error"}),this.$router.replace("/cart"))},payment(){const t=`https://vue3-course-api.hexschool.io/api/nn_macaron/pay/${this.$route.params.id}`;this.isLoading=!0,this.axios.post(t).then((t=>{t.data.success?this.$router.push(`/order/complete/${this.$route.params.id}`):this.emitter.emit("sendMsg",{message:"付款失敗，請聯繫店家",status:"error"}),this.isLoading=!1})).catch((t=>{this.isLoading=!1,alert(t)}))}},created(){this.isSearch||this.getOrder(this.$route.params.id)}},j=s(89);const E=(0,j.Z)(q,[["render",O]]);var L=E},7061:function(t,e,s){s.d(e,{Z:function(){return S}});var r=s(3396),i=s(7139),o=s(9242);const a={class:"py-2 d-flex align-items-baseline justify-content-between"},n={class:"mb-0 fw-normal"},l={class:"ms-1"},d={class:"list-group rounded-0"},c={class:"d-flex flex-column flex-sm-row"},u={style:{"max-width":"100px"},class:"d-flex align-items-center mb-2 mb-sm-0 me-sm-4"},p=["src","alt"],m={class:"px-0 px-sm-3 w-auto align-self-sm-center"},g={key:0,class:"mt-2 mb-0"},b={key:1,class:"mt-2 mb-0"},h={class:"text-danger"},_={class:"badge rounded-pill bg-graySlight text-dark ms-2",style:{"vertical-align":"baseline"}},f={class:"my-2"},w={key:2,class:"input-group input-group-sm w-auto mb-2"},y=["onClick"],k=(0,r._)("i",{class:"bi bi-dash-lg"},null,-1),v=[k],x={class:"input-group-text bg-white border-start-0 border-end-0 border-gray text-center d-inline-block",style:{"min-width":"50px"}},$=["onClick"],C=(0,r._)("i",{class:"bi bi-plus-lg"},null,-1),D=[C],z={key:3,class:"mb-2"},I={class:"mb-0"},O=["onClick"],q={key:0,class:"position-fixed",style:{"z-index":"1058","backdrop-filter":"blur(5px)",top:"-100vh",height:"300vh",left:"-100vw",width:"300vw"}},j={class:"d-flex flex-column justify-content-center align-items-center h-100"},E={class:"card border px-3 py-1 bg-light shadow-lg",style:{"max-width":"90vw"}},L={class:"card-body text-center p-4"},M=(0,r._)("i",{class:"bi bi-exclamation-triangle-fill opacity-50",style:{"font-size":"4rem",color:"var(--bs-warning)"}},null,-1),W={class:"text-center"};function P(t,e,s,k,C,P){const U=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",a,[(0,r._)("h5",n,[(0,r.WI)(t.$slots,"title",{},(()=>[(0,r.Uk)("購物清單")])),(0,r._)("span",l,(0,i.zw)(`(${s.cartInfo.carts.reduce(((t,e)=>t+e.qty),0)})`),1)]),s.isEdit?((0,r.wg)(),(0,r.iD)("a",{key:0,href:"#",class:"link-gray link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover",onClick:e[0]||(e[0]=(0,o.iM)(((...t)=>P.checkDeleteItem&&P.checkDeleteItem(...t)),["prevent"]))},"清空購物車")):(0,r.kq)("",!0)]),(0,r._)("ul",d,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.cartInfo.carts,(e=>((0,r.wg)(),(0,r.iD)("li",{class:(0,i.C_)(["list-group-item d-flex flex-column-reverse flex-sm-row border-gray-subtle border-start-0 border-end-0 px-0",{"text-gray":!s.isEdit}]),key:e.id},[(0,r._)("div",c,[(0,r._)("div",u,[(0,r._)("img",{src:e.product.imageUrl,alt:e.product.title,class:"img-fluid"},null,8,p)]),(0,r._)("div",m,[(0,r.Wm)(U,{to:`/product/${e.product.id}`,class:(0,i.C_)(["link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover",{"fw-bolder":s.isEdit}]),target:"_blank"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.product.title),1)])),_:2},1032,["to","class"]),e.product.origin_price===e.product.price?((0,r.wg)(),(0,r.iD)("p",g,(0,i.zw)(`單價 NT$ ${t.$filters.currency(e.product.origin_price)}`),1)):((0,r.wg)(),(0,r.iD)("p",b,[(0,r.Uk)(" 單件優惠價 "),(0,r._)("span",h,(0,i.zw)(`NT$ ${t.$filters.currency(e.product.price)}`),1),(0,r._)("span",_,(0,i.zw)(`${Math.floor(e.product.price/e.product.origin_price*10)}折`),1)])),(0,r._)("p",f,(0,i.zw)(`規格：${e.product.unit}`),1),s.isEdit?((0,r.wg)(),(0,r.iD)("div",w,[(0,r._)("button",{type:"button",class:(0,i.C_)(["btn btn-outline-gray",{disabled:1===e.qty}]),onClick:t=>P.cartAdjustNum({product_id:e.product.id,qty:e.qty-1},e.id)},v,10,y),(0,r._)("span",x,(0,i.zw)(e.qty),1),(0,r._)("button",{type:"button",class:(0,i.C_)(["btn btn-outline-gray",{disabled:10===e.qty}]),onClick:t=>P.cartAdjustNum({product_id:e.product.id,qty:e.qty+1},e.id)},D,10,$)])):((0,r.wg)(),(0,r.iD)("p",z,(0,i.zw)(`數量：${e.qty}`),1)),(0,r._)("p",I,(0,i.zw)(`小計：${e.total} 元`),1)])]),s.isEdit?((0,r.wg)(),(0,r.iD)("button",{key:0,type:"button",class:"btn-close ms-auto",onClick:t=>P.checkDeleteItem(e),title:"移除品項"},null,8,O)):(0,r.kq)("",!0)],2)))),128))]),C.showDeleteConfirm?((0,r.wg)(),(0,r.iD)("div",q,[(0,r._)("div",j,[(0,r._)("div",E,[(0,r._)("div",L,[M,(0,r._)("p",null,(0,i.zw)(`確定要${""===C.deleteMsg?"清空購物車":`將"${C.deleteMsg}"從購物車移除`}嗎？`),1),(0,r._)("div",W,[(0,r._)("button",{type:"button",class:"btn btn-outline-danger me-2",onClick:e[1]||(e[1]=(...t)=>P.deleteItem&&P.deleteItem(...t))},(0,i.zw)(""===C.deleteMsg?"清空":"移除"),1),(0,r._)("button",{type:"button",class:"btn btn-gray ms-2",onClick:e[2]||(e[2]=t=>C.showDeleteConfirm=!1)}," 取消 ")])])])])])):(0,r.kq)("",!0)],64)}var U={data(){return{showDeleteConfirm:!1,deleteMsg:"",temp:{}}},props:["cartInfo","isEdit"],inject:["emitter"],methods:{cartAdjustNum(t,e){this.emitter.emit("cartAdjustNum",{data:t,cartId:e})},checkDeleteItem(t={}){this.temp=t,t.product?this.deleteMsg=this.temp.product.title:this.deleteMsg="",this.showDeleteConfirm=!0},deleteItem(){this.temp.id?this.emitter.emit("cartDeleteItem",this.temp.id):this.emitter.emit("cartReset"),this.showDeleteConfirm=!1}}},Z=s(89);const N=(0,Z.Z)(U,[["render",P]]);var S=N},6103:function(t,e,s){s.r(e),s.d(e,{default:function(){return b}});var r=s(3396);const i={class:"container py-3 py-lg-5"},o={class:"row flex-column-reverse flex-lg-row justify-content-lg-between"},a={key:0,class:"col-lg-4"},n={class:"col-lg-6"};function l(t,e,s,l,d,c){const u=(0,r.up)("OrderCard"),p=(0,r.up)("Orderlist"),m=(0,r.up)("OrderStatus");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",o,[d.getOrderComplete?((0,r.wg)(),(0,r.iD)("div",a,[(0,r.Wm)(u,{"cart-info":d.orderProducts,isEdit:!1},{title:(0,r.w5)((()=>[(0,r.Uk)("訂單資料")])),coupon:(0,r.w5)((()=>[(0,r.Uk)("優惠券折扣：")])),_:1},8,["cart-info"]),(0,r.Wm)(p,{"cart-info":d.orderProducts,isEdit:!1},{title:(0,r.w5)((()=>[(0,r.Uk)("訂單明細")])),_:1},8,["cart-info"])])):(0,r.kq)("",!0),(0,r._)("div",n,[(0,r.Wm)(m,{onOrderData:c.getOrder,isSearch:!1},null,8,["onOrderData"])])])])}var d=s(7061),c=s(6687),u=s(5486),p={data(){return{orderProducts:{},getOrderComplete:!1}},inject:["emitter"],components:{Orderlist:d.Z,OrderCard:c.Z,OrderStatus:u.Z},methods:{getOrder(t){this.orderProducts=t,this.getOrderComplete=!0}},created(){this.emitter.emit("updateCart")}},m=s(89);const g=(0,m.Z)(p,[["render",l]]);var b=g}}]);
//# sourceMappingURL=103.435ea4ce.js.map