"use strict";(self["webpackChunkproject_macaron"]=self["webpackChunkproject_macaron"]||[]).push([[341],{2698:function(t,e,i){i.d(e,{Z:function(){return x}});var r=i(3396),s=i(7139),a=i(9242);const o={class:"card h-100"},l={class:"zIndex position-absolute end-0 text-end p-2 icon-bg",style:{height:"5rem",width:"5rem"}},c=(0,r._)("i",{class:"bi bi-suit-heart"},null,-1),n=[c],d={key:0,class:"zIndex position-absolute mt-3 p-2 text-white bg-gray bg-opacity-75 rounded-end"},u={key:1,class:"zIndex position-absolute mt-3 p-2 text-white bg-gray bg-opacity-75 rounded-end"},p=["src","alt"],g={class:"card-body position-relative"},h={class:"d-flex flex-column justify-content-between h-100"},m={class:"card-title fw-bolder"},f={class:"mb-2"},y={key:0,class:"mb-2"},w={key:1,class:"mb-2"},b={class:"text-danger me-2"},_={class:"text-gray"},v=(0,r._)("i",{class:"bi bi-cart-plus me-2"},null,-1);function C(t,e,i,c,C,k){const D=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r._)("div",l,[(0,r._)("a",{href:"#",class:(0,s.C_)(["link-primary fs-4",{collected:k.isCollected}]),onClick:e[0]||(e[0]=(0,a.iM)((t=>k.setCollect(i.product.id)),["prevent"]))},n,2)]),"期間限定"===i.product.category?((0,r.wg)(),(0,r.iD)("p",d," 期間限定 ")):i.product.origin_price!==i.product.price?((0,r.wg)(),(0,r.iD)("p",u,(0,s.zw)(`特價 ${Math.floor(i.product.price/i.product.origin_price*10)} 折`),1)):(0,r.kq)("",!0),(0,r.Wm)(D,{to:`/product/${i.product.id}`,class:"overflow-hidden rounded-top border-dark",onClick:k.scrollTop},{default:(0,r.w5)((()=>[(0,r._)("img",{src:i.product.imageUrl,class:"card-img-top productImg",alt:i.product.title,style:{height:"300px","object-fit":"cover"}},null,8,p)])),_:1},8,["to","onClick"]),(0,r._)("div",g,[(0,r.Wm)(D,{to:`/product/${i.product.id}`,class:"stretched-link",onClick:k.scrollTop},null,8,["to","onClick"]),(0,r._)("div",h,[(0,r._)("h5",m,(0,s.zw)(i.product.title),1),(0,r._)("div",null,[(0,r._)("p",f,(0,s.zw)(i.product.unit),1),i.product.origin_price===i.product.price?((0,r.wg)(),(0,r.iD)("p",y,(0,s.zw)(`NT$ ${t.$filters.currency(i.product.origin_price)}`),1)):((0,r.wg)(),(0,r.iD)("p",w,[(0,r._)("span",b,(0,s.zw)(`NT$ ${t.$filters.currency(i.product.price)}`),1),(0,r._)("del",_,(0,s.zw)(`NT$ ${t.$filters.currency(i.product.origin_price)}`),1)])),(0,r._)("a",{href:"#",class:"zIndex position-relative btn btn-outline-secondary w-100",onClick:e[1]||(e[1]=(0,a.iM)((t=>k.emitter.emit("addCart",{product_id:i.product.id,qty:1})),["prevent"]))},[v,(0,r.Uk)("加到購物車")])])])])])}var k={data(){return{collect:""}},computed:{isCollected(){return this.collect.findIndex((t=>t===this.product.id))>-1}},props:["product"],inject:["emitter"],methods:{setCollect(t){this.emitter.emit("setCollect",t)},scrollTop(){window.scrollTo({top:0,behavior:"smooth"})}},created(){this.emitter.on("collectInfo",(t=>{this.collect=t})),this.emitter.emit("getCollectInfo")}},D=i(89);const $=(0,D.Z)(k,[["render",C]]);var x=$},4341:function(t,e,i){i.r(e),i.d(e,{default:function(){return S}});var r=i(3396),s=i(7139);const a={class:"container my-5"},o=(0,r._)("h5",{class:"fw-bolder mb-4"},"產品列表",-1),l={class:"row justify-content-between"},c={class:"col-lg-3"},n={class:"col-lg-9"},d={key:0,class:"alert alert-danger d-flex"},u=(0,r._)("i",{class:"bi bi-exclamation-triangle-fill me-1"},null,-1),p={class:"mb-0"},g={key:0},h={key:1,class:"row row-cols-1 row-cols-lg-3 g-3"};function m(t,e,i,m,f,y){const w=(0,r.up)("WebLoading"),b=(0,r.up)("ProductCategory"),_=(0,r.up)("ProductCard");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(w,{"is-loading":f.isLoading},null,8,["is-loading"]),(0,r._)("div",a,[o,(0,r._)("div",l,[(0,r._)("div",c,[(0,r.Wm)(b,{categories:f.categories,filter:f.filter,onSetFilter:y.setFilter,class:"sticky-sm-top pe-lg-2 me-0 me-lg-3",style:{top:"110px","z-index":"1"}},null,8,["categories","filter","onSetFilter"])]),(0,r._)("div",n,[0===y.filterData.length?((0,r.wg)(),(0,r.iD)("div",d,[u,(0,r._)("p",p,[(0,r.Uk)(" 找不到產品 "),f.filter?((0,r.wg)(),(0,r.iD)("span",g,(0,s.zw)(`(關鍵字："${f.filter}")，請使用其他關鍵字搜尋`),1)):(0,r.kq)("",!0)])])):((0,r.wg)(),(0,r.iD)("div",h,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.filterData,(t=>((0,r.wg)(),(0,r.iD)("div",{class:"col",key:t.id},[(0,r.Wm)(_,{product:t,onAddCart:y.addCart},null,8,["product","onAddCart"])])))),128))]))])])])],64)}var f=i(2698);const y={class:"mb-5"},w={class:"mb-2"},b={key:0},_=["selected"],v=["value","selected"],C={class:"mb-2"},k={class:"input-group"},D={type:"text",class:"form-control",placeholder:"如：巧克力",ref:"searchInput"},$=(0,r._)("i",{class:"bi bi-search me-1"},null,-1),x=[$];function z(t,e,i,a,o,l){return(0,r.wg)(),(0,r.iD)("div",y,[(0,r._)("p",w,[(0,r.Uk)(" 分類篩選"),o.searchKey?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("span",b,(0,s.zw)(`：${i.filter?i.filter:"全部產品"}`),1))]),(0,r._)("select",{class:"form-select mb-3",onChange:e[0]||(e[0]=(...t)=>l.setCategory&&l.setCategory(...t))},[(0,r._)("option",{disabled:"",selected:""!==o.searchKey},"請選擇產品分類",8,_),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.categories,((t,e)=>((0,r.wg)(),(0,r.iD)("option",{value:e,key:"type"+t,selected:i.filter===e},(0,s.zw)(`${e||"全部產品"} (${t})`),9,v)))),128))],32),(0,r._)("p",C,(0,s.zw)("關鍵字搜尋"+(o.searchKey?`："${o.searchKey}"`:"")),1),(0,r._)("div",{class:(0,s.C_)(["list-group-item list-group-item-action",{active:o.searchKey}])},[(0,r._)("div",k,[(0,r._)("input",D,null,512),(0,r._)("button",{type:"button",class:"btn btn-graySlight",onClick:e[1]||(e[1]=t=>l.search())},x)])],2)])}var I={data(){return{collapseCategory:{},collapseSearch:{},searchKey:""}},props:["categories","filter"],methods:{setCategory(t){this.searchKey="",this.$refs.searchInput.value="",this.$emit("setFilter",t.target.value)},search(){this.searchKey=this.$refs.searchInput.value,this.$emit("setFilter",this.searchKey)}},updated(){window.scrollTo({top:0})}},K=i(89);const j=(0,K.Z)(I,[["render",z]]);var T=j,F={data(){return{allData:[],filter:"",categories:{},isLoading:!1}},emits:["addCart"],inject:["emitter"],components:{ProductCard:f.Z,ProductCategory:T},computed:{filterData(){return""===this.filter?this.allData:this.allData.filter((t=>t.category===this.filter||t.title.indexOf(this.filter)>-1))}},methods:{getData(){const t="https://vue3-course-api.hexschool.io/api/nn_macaron/products/all";this.isLoading=!0,this.axios.get(t).then((t=>{t.data.success?(this.allData=t.data.products,this.getCategories()):this.getDataError(`(${t.data.message})`),this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.getDataError(`(${t})`)}))},getDataError(t=""){this.emitter.emit("sendMsg",{message:`產品無法載入 ${t}`,status:"error"})},getCategories(){this.categories[""]=this.allData.length,this.allData.forEach((t=>{-1===Object.keys(this.categories).indexOf(t.category)?this.categories[t.category]=1:this.categories[t.category]+=1}))},setFilter(t){this.filter=t},addCart(t){this.$emit("addCart",t)}},created(){this.getData(),this.emitter.on("filterStore",(t=>{this.filter=t})),this.emitter.emit("getFilterStore")}};const L=(0,K.Z)(F,[["render",m]]);var S=L}}]);
//# sourceMappingURL=341.f96e2233.js.map